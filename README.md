# Mailer ![](logo.png)

> ⏱ Скоро здесь появится демо приложения

Это приложение для организации email рассылки, предназначенное для самозанятых и небольших ИП. Когда нет необходимости в крупных и серьезных рассылках и мощных рекламных акциях, но есть необходимость в автоматизации рутины по уведомлению ваших клиентов о новых услугах или изменениях в тарифах. 

На создание меня натолкнула конкретная "боль" некоторых знакомых предпринимателей, а также желание написать приложение на микросервисной архитектуре, где каждый модуль был бы максимально автономен.

## Содержание

- [Основные функци](#functions)
- [Технологии](#technologies)
- [Установка и запуск](#start)
- [Работа с приложением](#work)
- [Структура проекта](#structure)
- [To do](#todo)

## <a name="functions">Основные функци</a>

- загрузка email адресов из файла xslx
- валидация адресов на дубликаты и корректностью написания
- загрузка и хранение файлов для последующего прикрепления к письмам
- создание уникального набора шаблонов писем из тем и текстов перед отправкой
- рассылка только в рабочие часы с 9-00 до 18-00, каждые 20 минут

## <a name="technologies">Технологии</a>

- Spring Framework (Boot, Cloud (Eureka), Web, Data)
- MySQL
- Docker / Docker-compose
- JUnit / Mockito
- паттерны REST и MVC
- Java Mail API
- Freemarker / Bootstrap

## <a name="start">Установка и запуск на локальном компьютере</a>

1. Для начала вам необходимо установить [Docker](https://www.docker.com/products/docker-desktop/) 

2. Затем скопировать [репозиторий](https://github.com/SerhioGonsales/Mailing_web_app.git) 
или просто загрузить [архив](https://github.com/SerhioGonsales/Mailing_app/archive/refs/heads/master.zip) с приложением

3. Пока приложение работает только с Яндекс почтой. Ниже инструкция, что настроить в почте и где найти пароль для приложения.

  - Находим значок ⚙️ в верхнем правом углу своей почты

  <img src="/images/yandex.png" alt="Настройка яндекс почты" width="700" height="45"/>

  - Затем выполняем простые манипуляции

> _Шестеренка -> все настройки -> почтовые программы -> 
> поставить галочку в "С сервера imap.yandex.ru ..."_
> 
> _Шестеренка -> все настройки -> безопасность -> пароли приложений 
> -> почта -> создать новый пароль для приложения_

  - После этого добавляем ваш **username@yandeх.ru** и только что полученный **пароль для приложений** в ``.env`` файл, который находится в корне проекта

<img src="/images/env.png" alt="env файл" width="700" height="180"/>

4. После всех настроек запускаем приложение из терминала из корневой папки проекта простой командой
```sh
 C:\Mailing_web_app> docker-compose up
```

## <a name="work">Работа с приложением</a>

После запуска я приглашаю вас пройти по адресу ```http://localhost:8080``` в вашем браузере. Вас встретит главная страница приложения с приветствием и несколькоми вкладками: Адреса, Письма и Рассылка.

<img src="/images/menu.png" alt="Главная страница"/>

_**Вкладка "Адреса"**_
- форма загрузка файла *.xlsx со списком email адресов
- сброс пометок "отправлено" с адресов на которые были отправлены письма
- очистка базы данных

<img src="/images/emails.png" alt="вкладка Адреса"/>

_**Вкладка "Письма"**_
- добавление тем для писем
- загрузка файла *.html с текстом для тела письма
- загрузка любого файл для прикрепления к письмам
- возможность очистки каждой категории

<img src="/images/messages.png" alt="вкладка Письма"/>

_**Вкладка "Рассылка"**_
- отправка тестового письма себе на почту
- начало рассылки

<img src="/images/mailing.png" alt="вкладка Рассылка"/>

## <a name="structure">Структура проекта</a>

Так как проект предполагает микросервисную архитектуру основанную на технологии Eureka от Netflix, то хочу поделиться с вами небольшой схемой моего скромного приложения. 

<img src="/images/shema.png" alt="схема Рассылатора"/>

### Служебные модули:
```sh
**Eureka server**

Служит местом регистрации всех сервисов приложения и организует их взаимодействие.
```

```sh
**API Gateway**

Этот сервис является т.н. шлюзом, который обрабатывает все входящие запросы и распределеят их соответсвующим сервисам.
```

### Сервисы:
```sh
**Content service**

Предназначен для работы с контентом для писем, а именно: темами, текстами и вложенными файлами.
Обрабатывает их и сохраняет в бд.
Возвращает их списками или по отдельности.
```


```sh
**Email service**
  
Выполняет все операции с email адресами: загрузка файла, парсинг и сохранение в бд.
Возвращает список email. 
```

```sh
**Mailing service**
  
Сервис непосредственно отвечающий за саму отправку писем.
Запрашивает из Email service адреса, а из Message service шаблоны писем и делает рассылку
этих шаблонов по всему списку адресов. 
```

```sh
**Message service**
  
Запрашивает у Content service контент (темы, тексты и адреса файлов) и создает, а потом сохраняет уникальные шаблоны.
Возвращает вновь созданый список шаблонов для рассылки.
```

```sh
**View service**

Отвечает за GUI приложения.  
```

### Схемы в БД
- Content
- Messages
- Emails

## <a name="todo">To do</a>

- [ ] Сделать личный кабинет для возможности индивидуальной настройки рассылки
- [ ] Реализовать функцию отслеживания недоставленных писем и добавления их в отдельную базу
- [ ] Добавить возможность подключать несколько почтовых ящиков
